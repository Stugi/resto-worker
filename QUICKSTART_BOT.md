# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç Telegram –±–æ—Ç–∞

## –°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± - —Ç–µ—Å—Ç–∏—Ä—É–π –Ω–∞ Vercel ‚ú®

–ü–æ—Å–ª–µ push –≤ GitHub, Vercel –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ø–ª–æ–∏—Ç. –ü—Ä–æ—Å—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–∏ webhook:

```bash
yarn bot:set-webhook https://resto-worker.vercel.app/api/bot/webhook
```

–ì–æ—Ç–æ–≤–æ! –ú–æ–∂–µ—à—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –±–æ—Ç–∞ –≤ Telegram.

---

## –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

‚ö†Ô∏è **–¢—Ä–µ–±—É–µ—Ç—Å—è —Ç—É–Ω–Ω–µ–ª—å (ngrok/localtunnel)**, —Ç.–∫. Telegram –Ω—É–∂–µ–Ω HTTPS –¥–æ—Å—Ç—É–ø.

### –í–∞—Ä–∏–∞–Ω—Ç 1: ngrok (—Ç—Ä–µ–±—É–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é)

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Å—è –Ω–∞ https://ngrok.com
2. –£—Å—Ç–∞–Ω–æ–≤–∏ authtoken: `ngrok config add-authtoken YOUR_TOKEN`
3. –ó–∞–ø—É—Å—Ç–∏ dev: `yarn dev`
4. –ó–∞–ø—É—Å—Ç–∏ —Ç—É–Ω–Ω–µ–ª—å: `ngrok http 3000`
5. –£—Å—Ç–∞–Ω–æ–≤–∏ webhook: `yarn bot:set-webhook https://YOUR_NGROK_URL/api/bot/webhook`

### –í–∞—Ä–∏–∞–Ω—Ç 2: localtunnel (–±–µ–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏ localtunnel
npm install -g localtunnel

# –ó–∞–ø—É—Å—Ç–∏ dev —Å–µ—Ä–≤–µ—Ä
yarn dev

# –í –Ω–æ–≤–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –∑–∞–ø—É—Å—Ç–∏ —Ç—É–Ω–Ω–µ–ª—å
lt --port 3000

# –£—Å—Ç–∞–Ω–æ–≤–∏ webhook
yarn bot:set-webhook https://YOUR_LT_URL/api/bot/webhook
```

---

## –ö–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –±–æ—Ç–∞

1. –ù–∞–π–¥–∏ —Å–≤–æ–µ–≥–æ –±–æ—Ç–∞ –≤ Telegram (–∏–º—è –≤–∏–¥–Ω–æ –≤ @BotFather)
2. –ù–∞–ø–∏—à–∏ `/start`
3. –ü—Ä–æ–π–¥–∏ –≤–µ—Å—å –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥:
   - –í–≤–µ–¥–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
   - –í—ã–±–µ—Ä–∏ –º–∞—Å—à—Ç–∞–± (1, 2-5, 5+ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤)
   - –ü–æ–¥–µ–ª–∏—Å—å –∫–æ–Ω—Ç–∞–∫—Ç–æ–º
   - –í–≤–µ–¥–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞
   - –ü–æ–ª—É—á–∏ –º–∞–≥–∏—á–µ—Å–∫—É—é —Å—Å—ã–ª–∫—É –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≥—Ä—É–ø–ø–æ–≤–æ–≥–æ —á–∞—Ç–∞

---

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –£–¥–∞–ª–∏—Ç—å webhook
yarn bot:delete-webhook

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–∏–π webhook
curl https://api.telegram.org/bot<TOKEN>/getWebhookInfo
```

---

## –ß—Ç–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–µ?

1. ‚úÖ **User** (—Ä–æ–ª—å: OWNER)
   - telegramId
   - phone
   - login (–∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è: `owner_XXXXXX`)
   - botState (–ø—Ä–æ–≥—Ä–µ—Å—Å –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞)

2. ‚úÖ **Organization**
   - name (–≤–≤–µ–¥–µ–Ω–Ω–æ–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º)
   - —Å–≤—è–∑—å —Å –≤–ª–∞–¥–µ–ª—å—Ü–µ–º

3. ‚úÖ **Billing**
   - status: TRIAL (—Ç—Ä–∏–∞–ª –Ω–∞ –º–µ—Å—è—Ü)
   - trialStartsAt: —Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞

4. ‚úÖ **Restaurant**
   - name (–ø–µ—Ä–≤—ã–π —Ä–µ—Å—Ç–æ—Ä–∞–Ω)
   - —Å–≤—è–∑—å —Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–µ–π

---

## –ú–∞–≥–∏—á–µ—Å–∫–∞—è —Å—Å—ã–ª–∫–∞

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞ –±–æ—Ç –≤—ã–¥–∞–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É:

```
https://t.me/YOUR_BOT?startgroup=reg_RESTAURANT_ID
```

–ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –Ω–µ—ë:
- –°–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤–∞—è –≥—Ä—É–ø–ø–∞ –≤ Telegram
- –ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –≥—Ä—É–ø–ø—É
- –ì—Ä—É–ø–ø–∞ –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç—Å—è –∫ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—É
- –ú–µ–Ω–µ–¥–∂–µ—Ä—ã –º–æ–≥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ç—É–¥–∞ –æ—Ç—á–µ—Ç—ã

---

## Troubleshooting

**–ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ü—Ä–æ–≤–µ—Ä—å webhook: `curl https://api.telegram.org/bot<TOKEN>/getWebhookInfo`
- –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ –Ω–∞ Vercel
- –£–±–µ–¥–∏—Å—å, —á—Ç–æ TELEGRAM_BOT_TOKEN —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è Vercel

**–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏:**
- –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ DATABASE_URL —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ Vercel
- –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ –æ—à–∏–±–æ–∫ –≤ Vercel Dashboard

---

–ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [`docs/TELEGRAM_BOT.md`](docs/TELEGRAM_BOT.md)
